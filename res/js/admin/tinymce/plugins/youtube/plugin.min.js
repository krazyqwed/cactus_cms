tinymce.PluginManager.add('youtube', function (editor) {
    function openmanager() {
        var title = "Choose YouTube Video";
        if (typeof tinymce.settings.youtube_title !== "undefined" && tinymce.settings.youtube_title) {
            title = tinymce.settings.youtube_title;
        }
        win = editor.windowManager.open({
            title: title,
            file: base_url + 'admin/youtube_init',
            filetype: 'video',
            width: 785,
            height: 590,
            inline: 1,
            buttons: [{
                text: 'cancel',
                onclick: function () {
                    this.parent().parent().close();
                }
            }]
        });
    }
    editor.addButton('youtube', {
        icon: true,
        image: tinyMCE.baseURL + '/plugins/youtube/icon.png',
        tooltip: 'Insert/edit Youtube video',
        shortcut: 'Ctrl+Q',
        onclick: openmanager
    });
    editor.addShortcut('Ctrl+Q', '', openmanager);
    editor.addMenuItem('youtube', {
        icon: 'media',
        text: 'Insert Youtube video',
        shortcut: 'Ctrl+Q',
        onclick: openmanager,
        context: 'insert'
    });
});